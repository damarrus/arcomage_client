<!--This Document is generated by GameMaker, if you edit it by hand then you do so at your own risk!-->
<object>
  <spriteName>sp_Card</spriteName>
  <solid>0</solid>
  <visible>-1</visible>
  <depth>-1</depth>
  <persistent>0</persistent>
  <parentName>&lt;undefined&gt;</parentName>
  <maskName>&lt;undefined&gt;</maskName>
  <events>
    <event eventtype="0" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>//CardName        = obj_CurrentCard.CardName;
//CardID          = obj_CurrentCard.CardCost;
//CardDamage      = obj_CurrentCard.CardDamage;
//CardNmbAtHand   = obj_CurrentCard.CardNmbAtHand;

CardSpIndex = 0;
CardID              = obj_CurrentCard.CardID;
CardRes1            = obj_CurrentCard.CardRes1;
CardRes2            = obj_CurrentCard.CardRes2;
CardRes3            = obj_CurrentCard.CardRes3;
CardName            = obj_CurrentCard.CardName;
CardNmbAtHand       = obj_CurrentCard.CardNmbAtHand;
AtHand              = obj_CurrentCard.AtHand;
Discarded           = obj_CurrentCard.Discarded;

CardSelfTowerHp     = obj_CurrentCard.CardSelfTowerHp;
CardEnemyTowerHp    = obj_CurrentCard.CardEnemyTowerHp;
CardSelfWallHp      = obj_CurrentCard.CardSelfWallHp;
CardEnemyWallHp     = obj_CurrentCard.CardEnemyWallHp;
CardSelfHp          = obj_CurrentCard.CardSelfHp;
CardEnemyHp         = obj_CurrentCard.CardEnemyHp;


CardSelfRes1        = obj_CurrentCard.CardSelfRes1; 
CardSelfRes2        = obj_CurrentCard.CardSelfRes2;
CardSelfRes3        = obj_CurrentCard.CardSelfRes3;
CardSelfGen1        = obj_CurrentCard.CardSelfGen1;
CardSelfGen2        = obj_CurrentCard.CardSelfGen2;
CardSelfGen3        = obj_CurrentCard.CardSelfGen3;

CardEnemyRes1       = obj_CurrentCard.CardEnemyRes1; 
CardEnemyRes2       = obj_CurrentCard.CardEnemyRes2;
CardEnemyRes3       = obj_CurrentCard.CardEnemyRes3;
CardEnemyGen1       = obj_CurrentCard.CardEnemyGen1;
CardEnemyGen2       = obj_CurrentCard.CardEnemyGen2;
CardEnemyGen3       = obj_CurrentCard.CardEnemyGen3;

ResourceStorage1    = obj_GameController.SelfRes1;
ResourceStorage2    = obj_GameController.SelfRes2;
ResourceStorage3    = obj_GameController.SelfRes3;

if (AtHand and (CardRes1 &gt; ResourceStorage1 or CardRes2 &gt; ResourceStorage2 or CardRes3 &gt; ResourceStorage3)) or Discarded 
{        
    CardSpIndex = 1;    
}
else if AtHand 
{     
    CardSpIndex = 0;       
}




</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="6" enumb="8">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>//событие discard
if obj_GameController.IsItMyTime and AtHand 
{
script_execute(DeleteCardsField); //Удаляем карты с центра поля (использованые карты)

//Говорим серверу, что отправили туда определенную карту ID
script_execute(SetJSmap, "useCard", "card_id", CardID, "discard", true);
script_execute(SendToSrv);
    
//Переносим карту в центр поля, убираем из руки, делаем неактивной
x = obj_TableField.x - 200;
y = obj_TableField.y;
AtHand = false;
Usable = false;

//Устанавливаем серый спрайт
CardSpIndex = 1; 
//Сдвигаем руку влево
script_execute(MoveHandLeft, CardNmbAtHand);


obj_GameController.IsItMyTime = false;
//script_execute(GetTurn);
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="6" enumb="7">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>if depth &gt; obj_Blocker.depth {exit;}

var ResourceStorage1 = obj_GameController.SelfRes1,
    ResourceStorage2 = obj_GameController.SelfRes2,
    ResourceStorage3 = obj_GameController.SelfRes3;  
    

if obj_GameController.IsItMyTime and AtHand and (CardRes1 &lt;= ResourceStorage1 and CardRes2 &lt;= ResourceStorage2 and CardRes3 &lt;= ResourceStorage3) 
{
script_execute(DeleteCardsField); //Удаляем карты с центра поля (использованые карты)

//Записываем выбранную карту в текущую
obj_CurrentCard.CardName            = CardName; 
obj_CurrentCard.CardID              = CardID;
obj_CurrentCard.CardRes1            = CardRes1;
obj_CurrentCard.CardRes2            = CardRes2;
obj_CurrentCard.CardRes3            = CardRes3;

obj_CurrentCard.CardSelfTowerHp     = CardSelfTowerHp;
obj_CurrentCard.CardEnemyTowerHp    = CardEnemyTowerHp;
obj_CurrentCard.CardSelfWallHp      = CardSelfWallHp;
obj_CurrentCard.CardEnemyWallHp     = CardEnemyWallHp;
obj_CurrentCard.CardSelfHp          = CardSelfHp;
obj_CurrentCard.CardEnemyHp         = CardEnemyHp;

obj_CurrentCard.CardNmbAtHand       = CardNmbAtHand;

obj_CurrentCard.CardSelfRes1 = CardSelfRes1; 
obj_CurrentCard.CardSelfRes2 = CardSelfRes2;
obj_CurrentCard.CardSelfRes3 = CardSelfRes3;
obj_CurrentCard.CardSelfGen1 = CardSelfGen1;
obj_CurrentCard.CardSelfGen2 = CardSelfGen2;
obj_CurrentCard.CardSelfGen3 = CardSelfGen3;

obj_CurrentCard.CardEnemyRes1 = CardEnemyRes1; 
obj_CurrentCard.CardEnemyRes2 = CardEnemyRes2;
obj_CurrentCard.CardEnemyRes3 = CardEnemyRes3;
obj_CurrentCard.CardEnemyGen1 = CardEnemyGen1;
obj_CurrentCard.CardEnemyGen2 = CardEnemyGen2;
obj_CurrentCard.CardEnemyGen3 = CardEnemyGen3;




//Говорим серверу, что отправили туда определенную карту ID
script_execute(SetJSmap, "useCard", "card_id", CardID, "discard", false);
script_execute(SendToSrv);
    
//Переносим карту в центр поля, убираем из руки, делаем неактивной
x = obj_TableField.x - 200;
y = obj_TableField.y;
AtHand = false;
Usable = false;

//Сдвигаем руку влево, обыгрываем карту
script_execute(MoveHandLeft, CardNmbAtHand);
script_execute(PlayCurrentCard);
script_execute(SetCardVision);

obj_GameController.IsItMyTime = false;

}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="8" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>draw_sprite(sp_Card,CardSpIndex, x, y);
draw_set_colour(c_yellow);
draw_set_font(font1);
draw_set_halign(fa_center);
CardNameText = string_replace(CardName, " ", "#");
CardNameText = string_replace(CardNameText, "(newcard)", "");
draw_text(x, y + 40, CardNameText);
draw_set_colour(c_black);
draw_text(x - 60, y + 80, CardSelfTowerHp);
draw_text(x + 60, y + 80, CardEnemyTowerHp);
draw_set_colour(c_white);
description = ""; 
TextCost = "";

draw_text(x, y - 135, string(CardRes1) + "  " + string(CardRes2) + "  " + string(CardRes3));

draw_set_colour(c_yellow);

//Формирование описалова
GrSelfRes = false;
GrEnemyRes = false;
GrSelfGen = false;
GrEnemyGen = false;
//РЕСУРСЫ 
if  CardSelfRes1 &lt;&gt; 0 or CardEnemyRes1 &lt;&gt; 0  
{

    if  CardSelfRes1 = CardSelfRes2 
        and CardSelfRes1 = CardSelfRes3 
        and CardSelfRes1 = CardEnemyRes1 
        and CardSelfRes1 = CardEnemyRes2
        and CardSelfRes1 = CardEnemyRes3
    {    
        description += script_execute(GetValueWithPM, CardSelfRes1) + " к ресурсам#всех игроков#"
        GrSelfRes = true;
        GrEnemyRes = true;
        
    } 
    else
    { 
        if  CardSelfRes1 = CardSelfRes2 
            and CardSelfRes1 = CardSelfRes3
            and CardSelfRes1 &lt;&gt; 0
        {    
            description += script_execute(GetValueWithPM, CardSelfRes1) + " к ресурсам#"
            GrSelfRes = true;
        }
        
        if  CardEnemyRes1 = CardEnemyRes2 
            and CardEnemyRes1 = CardEnemyRes3
            and CardEnemyRes1 &lt;&gt; 0
        {    
            description += script_execute(GetValueWithPM, CardEnemyRes1) + " к ресурсам#врага#"
            GrEnemyRes = true;
        }
    }
    
} 

if !GrSelfRes //Если ресурсы не сгруппировались по условиям выше, то добавляем каждый рес. отдельно
{ 
    if CardSelfRes1 &lt;&gt; 0 {description += script_execute(GetValueWithPM, CardSelfRes1)+ " к 1 ресурсу #"}
    if CardSelfRes2 &lt;&gt; 0 {description += script_execute(GetValueWithPM, CardSelfRes2)+ " к 2 ресурсу #"}
    if CardSelfRes3 &lt;&gt; 0 {description += script_execute(GetValueWithPM, CardSelfRes3)+ " к 3 ресурсу #"}
}

if !GrEnemyRes
{
    if CardEnemyRes1 &lt;&gt; 0 {description += script_execute(GetValueWithPM, CardEnemyRes1)+ " к 1 ресурсу #врага#"}
    if CardEnemyRes2 &lt;&gt; 0 {description += script_execute(GetValueWithPM, CardEnemyRes2)+ " к 2 ресурсу #врага#"}
    if CardEnemyRes3 &lt;&gt; 0 {description += script_execute(GetValueWithPM, CardEnemyRes3)+ " к 3 ресурсу #врага#"}
}

//ГЕНЕРАТОРЫ ПРИРОСТ
if  CardSelfGen1 &lt;&gt; 0 or CardEnemyGen1 &lt;&gt; 0  
{

    if  CardSelfGen1 = CardSelfGen2 
        and CardSelfGen1 = CardSelfGen3 
        and CardSelfGen1 = CardEnemyGen1 
        and CardSelfGen1 = CardEnemyGen2
        and CardSelfGen1 = CardEnemyGen3
    {    
        description += script_execute(GetValueWithPM, CardSelfGen1) + " к приросту#всех игроков#"
        GrSelfGen = true;
        GrEnemyGen = true;
        
    }
    else
    {  
        if  CardSelfGen1 = CardSelfGen2 
            and CardSelfGen1 = CardSelfGen3
            and CardSelfGen1 &lt;&gt; 0
        {    
            description += script_execute(GetValueWithPM, CardSelfGen1) + " к приросту#"
            GrSelfGen = true;
        }
        
        if  CardEnemyGen1 = CardEnemyGen2 
            and CardEnemyGen1 = CardEnemyGen3
            and CardEnemyGen1 &lt;&gt; 0
        {    
            description += script_execute(GetValueWithPM, CardEnemyGen1) + " к приросту#врага#"
            GrEnemyGen = true;
        }
    }
} 

if !GrSelfGen
{
    if CardSelfGen1 &lt;&gt; 0 {description += script_execute(GetValueWithPM, CardSelfGen1)+ " к 1 приросту#"}
    if CardSelfGen2 &lt;&gt; 0 {description += script_execute(GetValueWithPM, CardSelfGen2)+ " к 2 приросту#"}
    if CardSelfGen3 &lt;&gt; 0 {description += script_execute(GetValueWithPM, CardSelfGen3)+ " к 3 приросту#"}
}

if !GrEnemyGen
{
    if CardEnemyGen1 &lt;&gt; 0 {description += script_execute(GetValueWithPM, CardEnemyGen1)+ " к 1 приросту#врага#"}
    if CardEnemyGen2 &lt;&gt; 0 {description += script_execute(GetValueWithPM, CardEnemyGen2)+ " к 2 приросту#врага#"}
    if CardEnemyGen3 &lt;&gt; 0 {description += script_execute(GetValueWithPM, CardEnemyGen3)+ " к 3 приросту#врага#"}
}

if CardSelfWallHp = CardEnemyWallHp and CardSelfWallHp &lt;&gt; 0 
{
    description += script_execute(GetValueWithPM, CardSelfWallHp)+ " ко всем стенам#"    
}
else
{
    if CardSelfWallHp &lt;&gt; 0 {description += script_execute(GetValueWithPM, CardSelfWallHp)+ " к стене#";}
    if CardEnemyWallHp &lt;&gt; 0 {description += script_execute(GetValueWithPM, CardEnemyWallHp) + " к стене врага#";}
}

if CardSelfHp = CardEnemyHp and CardSelfHp &gt; 0
{
    description += string(abs(script_execute(GetValueWithPM, CardSelfHp)))+ " урона всем игрокам#"; 
}
else
{
    if CardSelfHp   &lt;&gt; 0 {description += string(abs(script_execute(GetValueWithPM, CardSelfHp))) + " урона себе#";}
    if CardEnemyHp  &lt;&gt; 0 {description += string(abs(script_execute(GetValueWithPM, CardEnemyHp))) + " урона#";}    
}

draw_set_font(font2);
draw_set_colour(c_black);
draw_text(x, y + 100, description);




 
</string>
          </argument>
        </arguments>
      </action>
    </event>
  </events>
  <PhysicsObject>0</PhysicsObject>
  <PhysicsObjectSensor>0</PhysicsObjectSensor>
  <PhysicsObjectShape>0</PhysicsObjectShape>
  <PhysicsObjectDensity>0.5</PhysicsObjectDensity>
  <PhysicsObjectRestitution>0.100000001490116</PhysicsObjectRestitution>
  <PhysicsObjectGroup>0</PhysicsObjectGroup>
  <PhysicsObjectLinearDamping>0.100000001490116</PhysicsObjectLinearDamping>
  <PhysicsObjectAngularDamping>0.100000001490116</PhysicsObjectAngularDamping>
  <PhysicsObjectFriction>0.200000002980232</PhysicsObjectFriction>
  <PhysicsObjectAwake>-1</PhysicsObjectAwake>
  <PhysicsObjectKinematic>0</PhysicsObjectKinematic>
  <PhysicsShapePoints/>
</object>
